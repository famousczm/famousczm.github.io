---
title: Linux添加磁盘
date: 2016-10-08 14:13:13
tags: Linux
---
今天学习了Linux关于磁盘的知识，以添加磁盘为例总结一下：

- <small>我用的是VirtualBox虚拟机，先关掉Linux，然后在VBox的设置->存储->控制器，右键添加虚拟硬盘->选创建一个新的虚拟盘->选VDI->动态分配->然后就分配自己想要的磁盘大小，不过要在分配的那个盘所接受的范围内就行。</small>

- <small>创建好后，运行Linux。</small>

- <small>为新添加的磁盘分区。用管理员权限输入命令</small>

```
fdisk -l
```
查看目前磁盘信息，看到

```
Disk /dev/sdb: 8589 MB, 8589934592 bytes
```
这一行信息中的/dev/sdb就是新添加的磁盘了（不知道是不是都是叫sdb的…检查一下大小与自己划分的一样就是了，这里我用了默认的8G）

- <small>确认好新增的磁盘后，再输入：</small>

```
fdisk /dev/sdb
```

进入分区模式，这里有一堆命令可操作，用常见的’p’查看当前磁盘的分区情况、’n’建立一个新分区和’d’删除一个分区，这几个命令即可。输入p，可以看见磁盘sdb并没有被分过区

再输入n，开始分区，可以选择’e’扩展分区，’p’主分区，之前看鸟哥的教程时看得糊里糊涂，实操之后就知道是怎么回事了，总共可以分4个分区，可以是四个主分区，但是如果想要分不止四个分区的话，就要用扩展分区了，可以三个主分区+一个扩展分区，然后再从扩展分区里划分逻辑分区，前三个主分区的标识是sdb1，sdb2，sdb3，扩展分区是sdb4，逻辑分区是由sdb5开始一直推算下去的。这里无论前面四个分区怎么设置，只划分一个也好，逻辑分区都是从sdb5开始的。还有一点必须要注意的是，划分了扩展分区后，剩下的只能从扩展分区中划分逻辑分区了，不管你之前的空间有没有分配完，所以一般主分区划分完后，剩下的所有空间一股脑的全塞给扩展分区就对了，不要省着，省着就是浪费了。

不小心分错了也不要紧张，因为还没有保存，可以用ctrl+c快速退出，再重新分区，所以可以好好研究研究一下吧，不过怎么说分区都是个高危工作，如果磁盘里有重要资料的话还是小心一点为妙。

- <small>格式化磁盘。分好区后，输入命令：</small>

```
mke2fs -t ext4 -L TEST /dev/sdb5
```

我系统是CentOS6.5，所以文件系统用的是ext4，设置了标签TEST

- <small>挂载磁盘。磁盘要挂载在一个目录中，才能使用这个磁盘，但是如果一个目录原先有文件存在的话，挂载磁盘后所有数据将会被覆盖，消失了。卸载磁盘后才可以看到。就是这么回事，所以就要找个空目录来挂载咯。 我在根目录下新建一个目录newdir，输入命令：</small>

```
mount /dev/sdb5 /newdir/
```

再看看磁盘信息

```
df -h
```

显示信息，挂载成功

```
[root@localhost user1]# df -h
Filesystem                    Size  Used Avail Use% Mounted on
/dev/mapper/VolGroup-lv_root  7.5G  738M  6.4G  11% /
tmpfs                         250M     0  250M   0% /dev/shm
/dev/sda1                     485M   31M  429M   7% /boot
/dev/sdb5                     989M   18M  921M   2% /newdir
```

- <small>设置开机挂载。在文件/etc/fstab最后一行，添加我新磁盘sdb5的信息</small>

```
LABEL=TEST        /newdir         ext4    defaults        0 0
```

保存退出，设置完成

不懂的地方还是有很多，不过思路总算明朗了一点，最后想说的是LABEL经常打错成LABLE啊啊啊，导致好几次运行出错，英语也要好好学啊，切记切记…





